- job:
    name: fuel-upgrade-master
    logrotate:
      daysToKeep: 10
      numToKeep: 10
      artifactDaysToKeep: -1
      artifactNumToKeep: 1
    scm:
      - git:
          url: https://github.com/stackforge/fuel-main.git
          branches:
            - master
          skip-tag: true
          wipe-workspace: false
    builders:
      - copyartifact:
          project: fuel-artifacts-master
          filter: artifacts/*
          target: objects/master
          flatten: true
      - copyartifact:
          project: fuel-artifacts-5.0.x
          filter: artifacts/*
          target: objects/5.0.x
          flatten: true
      - shell: |
          git review -x 107730
          git review -x 107866
          git review -x 108128
          rm -rf artifacts
          make deep_clean
          make OBJ_DIR=objects USE_MIRROR=msk BUILD_ARTIFACTS=0 EXTRA_RELEASES="master 5.0.x" TARBALL_DIR=artifacts upgrade
    publishers:
      - archive:
          artifacts: artifacts/*
          latest-only: true
    triggers:
      - timed: #H H(6-7) * * 1-5
    wrappers:
      - timeout:
          timeout: 90
          fail: true
